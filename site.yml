---
# =============================================================================
# PLAYBOOK PRINCIPAL - ConfiguraciÃ³n completa del laboratorio
# =============================================================================
# UN SOLO archivo para configurar TODO el laboratorio
# Uso: ansible-playbook site.yml
# =============================================================================

- name: "ğŸ¯ LABORATORIO ACADÃ‰MICO Y GAMING - ConfiguraciÃ³n Completa"
  hosts: all
  become: yes
  gather_facts: yes
  
  pre_tasks:
    - name: "ğŸ” Verificar conectividad"
      ping:
      tags: always
      
    - name: "ğŸ“Š Mostrar informaciÃ³n del sistema"
      debug:
        msg: |
          ğŸ–¥ï¸  Host: {{ inventory_hostname }}
          ğŸ’» Sistema: {{ ansible_distribution }} {{ ansible_distribution_version }}
          ğŸŒ IP: {{ ansible_default_ipv4.address | default('Sin IP') }}
          ğŸ·ï¸  Tipo: {{ lab_type | default('general') }}
      tags: always

  roles:
    # 1ï¸âƒ£ SISTEMA - ConfiguraciÃ³n base (OS, paquetes bÃ¡sicos)
    - role: sistema
      tags: [sistema, base]
      
    # 2ï¸âƒ£ SERVICIOS - SSH, DNS, DHCP, etc.
    - role: servicios  
      tags: [servicios, services]
      
    # 3ï¸âƒ£ USUARIOS - Cuentas, permisos, grupos
    - role: usuarios
      tags: [usuarios, users]
      
    # 4ï¸âƒ£ APLICACIONES - Software especÃ­fico por laboratorio
    - role: aplicaciones
      tags: [aplicaciones, apps]

  post_tasks:
    - name: "âœ… ConfiguraciÃ³n completada"
      debug:
        msg: |
          ğŸ‰ Â¡ConfiguraciÃ³n exitosa para {{ inventory_hostname }}!
          
          ğŸ“‹ Resumen:
          - Sistema configurado: âœ…
          - Servicios activos: âœ…  
          - Usuarios creados: âœ…
          - Aplicaciones instaladas: âœ…
          
          ğŸš€ El sistema estÃ¡ listo para usar
      tags: always

# =============================================================================
# PLAYBOOKS ESPECÃFICOS POR LABORATORIO (opcionales)
# =============================================================================

- name: "ğŸ® ConfiguraciÃ³n especÃ­fica GAMING"
  hosts: lab_gaming
  become: yes
  
  tasks:
    - name: "ğŸ® Configurar optimizaciones gaming"
      include_tasks: "{{ item }}"
      loop:
        - roles/aplicaciones/tasks/gaming.yml
      when: lab_type == 'gaming'
      
    - name: "ğŸ® Gaming configurado"
      debug:
        msg: "ğŸ® Laboratorio gaming listo - Steam, NVIDIA, etc."

- name: "ğŸ“š ConfiguraciÃ³n especÃ­fica ACADÃ‰MICO"  
  hosts: lab_academico
  become: yes
  
  tasks:
    - name: "ğŸ“š Configurar herramientas acadÃ©micas"
      include_tasks: "{{ item }}"
      loop:
        - roles/aplicaciones/tasks/academico.yml
      when: lab_type == 'academic'
      
    - name: "ğŸ“š AcadÃ©mico configurado"
      debug:
        msg: "ğŸ“š Laboratorio acadÃ©mico listo - LibreOffice, Python, etc."

# =============================================================================