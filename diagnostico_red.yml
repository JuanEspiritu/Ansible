---
# =============================================================================
# PLAYBOOK ESPECIAL - ConfiguraciÃ³n remota vÃ­a API/Scripts
# =============================================================================

- name: "ğŸš€ Configurar Ubuntu Server desde tu Mac"
  hosts: localhost
  connection: local
  gather_facts: no
  become: no
  
  vars:
    ubuntu_target_ip: "172.17.25.48"
    new_ip: "192.168.0.48"
    
  tasks:
    - name: "ğŸ“‹ InformaciÃ³n importante"
      debug:
        msg: |
          ğŸ¯ Para que Ansible funcione, necesitamos que Ubuntu Server estÃ© en tu red.
          
          ğŸ“ Estado actual:
          - Ubuntu Server: {{ ubuntu_target_ip }} (red del laboratorio)  
          - Tu Mac: 192.168.0.170 (red local)
          
          ğŸ’¡ Opciones disponibles:
          1. Cambiar Ubuntu Server a red local (requiere acceso a consola)
          2. Usar VPN/tÃºnel (complejo)
          3. Trabajar directamente desde la red del laboratorio
          
          ğŸ“ RecomendaciÃ³n educativa:
          Conectarte a la misma red que el laboratorio para experiencia real.
          
    - name: "ğŸ” Verificar conectividad actual"
      command: ping -c 1 {{ ubuntu_target_ip }}
      register: ping_result
      ignore_errors: yes
      changed_when: false
      
    - name: "ğŸ“Š Resultado de conectividad"
      debug:
        msg: |
          {% if ping_result.rc == 0 %}
          âœ… Hay conectividad bÃ¡sica a Ubuntu Server
          ğŸš€ Intentando configurar con Ansible...
          {% else %}
          âŒ No hay conectividad a Ubuntu Server  
          ğŸ“ Necesitas configuraciÃ³n de red primero
          {% endif %}
          
    - name: "ğŸ¯ Siguiente paso"
      debug:
        msg: |
          {% if ping_result.rc == 0 %}
          Ejecuta: ansible-playbook site.yml --ask-pass
          {% else %}
          Opciones:
          1. Configurar red manualmente en Ubuntu Server
          2. Conectarte a la red del laboratorio
          3. Pedir ayuda al administrador de la red
          {% endif %}